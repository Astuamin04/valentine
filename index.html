<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Be My Valentine üíò</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<style>
  :root{
    --bg1:#ff6f91; --bg2:#ff9eb5; --bg3:#ffd1dc; --ink:#7a0b2e; --accent:#ff2f6d;
  }
  *{ box-sizing:border-box }
  body{
    margin:0; height:100vh; overflow:hidden; display:grid; place-items:center;
    background: linear-gradient(120deg, var(--bg1), var(--bg2), var(--bg3));
    background-size: 200% 200%;
    animation: bgMove 14s ease infinite;
    font-family: system-ui, -apple-system, Segoe UI, sans-serif;
  }
  body.night{
    --bg1:#0b1026; --bg2:#141b3a; --bg3:#1f2a55; --ink:#f7d9ff;
  }
  @keyframes bgMove{ 0%{background-position:0% 50%} 50%{background-position:100% 50%} 100%{background-position:0% 50%} }

  .hud{ position:fixed; top:12px; left:12px; display:flex; gap:8px; z-index:9; flex-wrap:wrap }
  .pill{ border:none; border-radius:999px; padding:8px 12px; cursor:pointer; background:#fff; color:#7a0b2e; box-shadow:0 10px 25px rgba(0,0,0,.2) }
  body.night .pill{ background:#0f1533; color:#ffd1dc }
  .picker{ width:34px; height:34px; border-radius:50%; border:2px solid #fff; cursor:pointer; padding:0 }

  .scene{ position:relative; width:min(92vw,520px); perspective:900px }
  .card{
    position:relative; background: rgba(255,255,255,.28);
    backdrop-filter: blur(14px); border-radius:28px; padding:24px 20px 22px;
    box-shadow: 0 30px 80px rgba(255, 40, 90, .35), inset 0 1px 0 rgba(255,255,255,.6);
    transform-style:preserve-3d; transition: transform .2s ease;
    animation: slideIn .8s ease-out both;
  }
  @keyframes slideIn{ from{ transform: translateY(40px) scale(.96); opacity:0 } to{ transform: translateY(0) scale(1); opacity:1 } }
  .glow{ position:absolute; inset:-1px; border-radius:28px; pointer-events:none; animation: glow 2.8s ease-in-out infinite }
  @keyframes glow{ 0%,100%{ box-shadow:0 0 0 0 rgba(255,111,145,.0)} 50%{ box-shadow:0 0 40px 8px rgba(255,111,145,.35)} }
  body.night .glow{ animation:none }

  .title{ color:var(--ink); font-size:clamp(1.9rem,3.8vw,2.6rem); text-align:center; margin:6px 0 8px }
  .subtitle{ color:color-mix(in srgb, var(--ink) 80%, #000 20%); text-align:center; opacity:.9; margin-bottom:8px }

  .progressWrap{ width:100%; height:8px; border-radius:999px; background:rgba(255,255,255,.5); overflow:hidden; margin-bottom:10px }
  .progressBar{ height:100%; width:0%; background:linear-gradient(90deg, #ff2f6d, #ff8fb1); transition: width .4s ease }

  .buttons{ position:relative; height:220px }
  .btn{
    position:absolute; border:none; border-radius:999px; padding:14px 38px; cursor:pointer;
    background: linear-gradient(#fff, #ffe8ef); color:var(--accent); font-size:1.05rem;
    box-shadow:0 10px 25px rgba(255, 50, 100, .35);
    transition: left .18s ease, top .18s ease, transform .12s ease, box-shadow .2s ease;
  }
  .btn:hover{ transform: translateY(-1px) scale(1.01); box-shadow: 0 16px 36px rgba(255, 50, 100, .45) }
  #yes{ left:70px; top:110px }
  #no { left:230px; top:110px; color:#9ca3af }
  .locked{ filter: grayscale(.7) blur(.3px); pointer-events:none }

  .hearts span,.petals span,.balloons span,.confetti i{ position:absolute; pointer-events:none }
  .hearts span{ font-size:18px; animation: rise 6s linear infinite }
  @keyframes rise{ to{ transform:translateY(-120vh) rotate(360deg); opacity:0 } }
  .petals span{ font-size:18px; animation: fall 6s linear infinite }
  @keyframes fall{ to{ transform:translateY(120vh) rotate(180deg); opacity:0 } }
  .balloons span{ font-size:22px; animation: balloon 8s linear infinite }
  @keyframes balloon{ to{ transform:translateY(-120vh); opacity:0 } }
  .confetti i{ width:8px; height:12px; background:#fff; animation: confetti 1.2s ease-out forwards }
  @keyframes confetti{ to{ transform:translateY(120px) rotate(180deg); opacity:0 } }

  canvas{ position:fixed; inset:0; pointer-events:none }

  .shooting{ position:fixed; inset:0; pointer-events:none }
  .shooting i{
    position:absolute; width:2px; height:120px; background:linear-gradient(transparent, #fff);
    transform: rotate(45deg); opacity:.8; animation: shoot 1.1s linear forwards;
  }
  @keyframes shoot{ from{ transform:translate(0,0) rotate(45deg); opacity:1 } to{ transform:translate(-300px,300px) rotate(45deg); opacity:0 } }

  .toast{
    position:fixed; bottom:16px; left:50%; transform:translateX(-50%);
    background:#111827; color:#fff; padding:10px 14px; border-radius:999px; opacity:0;
    transition: opacity .3s ease, transform .3s ease; pointer-events:none
  }
  .toast.show{ opacity:1; transform:translateX(-50%) translateY(-6px) }

  .success{
    position:fixed; inset:0; display:grid; place-items:center; text-align:center; padding:24px;
    background: radial-gradient(circle at top, #ffd1dc, #ff9eb5 55%, #ff7aa2);
    color:#7a0b2e;
  }
  .box{
    background: rgba(255,255,255,.35); backdrop-filter: blur(12px);
    border-radius:28px; padding:26px 22px; box-shadow:0 30px 80px rgba(255, 40, 90, .35);
  }
  .actions{ display:flex; gap:10px; flex-wrap:wrap; justify-content:center; margin-top:16px }
</style>
</head>
<body>
<canvas id="fw"></canvas>
<div class="shooting" id="shooting"></div>

<div class="hud">
  <button class="pill" id="toggleNight">üåô Night</button>
  <button class="pill" data-theme="pink">üíñ</button>
  <button class="pill" data-theme="lav">üíú</button>
  <button class="pill" data-theme="gal">üåå</button>
  <input type="color" class="picker" id="picker" title="Pick accent color">
</div>

<div class="scene">
  <div class="card" id="card">
    <div class="glow"></div>
    <div class="progressWrap"><div class="progressBar" id="bar"></div></div>
    <div class="subtitle" id="sub">Quick warm-up üíó</div>
    <h1 class="title" id="q">Do you like cute surprises? ‚ú®</h1>
    <div class="buttons" id="arena">
      <button class="btn" id="yes">Yes üòä</button>
      <button class="btn" id="no">No üôà</button>
    </div>
    <div class="mini" id="mini" style="display:none"></div>
  </div>
</div>

<div class="hearts" id="hearts"></div>
<div class="petals" id="petals"></div>
<div class="balloons" id="balloons"></div>
<div class="confetti" id="confetti"></div>
<div class="toast" id="toast">üîê Secret unlocked!</div>

<script>
  let step=0, noCount=0, unlocked=false, code="";
  const baseQ=[
    "Do you like cute surprises? ‚ú®",
    "Do you enjoy little romantic gestures? üåπ",
    "Should we make more fun memories together? üí´",
    "Will you be my Valentine? üíñ"
  ];
  const altQ=[
    "That smile says yes üòÑ Ready for another?",
    "Looks like you‚Äôre enjoying this üòâ One more?",
    "Final boss question incoming‚Ä¶ üíò",
    "Will you be my Valentine? üíñ"
  ];

  const qEl=document.getElementById('q'), sub=document.getElementById('sub');
  const yes=document.getElementById('yes'), no=document.getElementById('no');
  const arena=document.getElementById('arena'), bar=document.getElementById('bar');

  // 3D tilt
  const card=document.getElementById('card');
  document.addEventListener('mousemove', e=>{
    const r=card.getBoundingClientRect();
    const cx=r.left+r.width/2, cy=r.top+r.height/2;
    const dx=(e.clientX-cx)/r.width, dy=(e.clientY-cy)/r.height;
    card.style.transform=`rotateY(${dx*10}deg) rotateX(${-dy*10}deg)`;
  });
  document.addEventListener('mouseleave', ()=> card.style.transform='rotateY(0) rotateX(0)');

  // Themes
  document.querySelectorAll('[data-theme]').forEach(b=>b.onclick=()=>{
    const t=b.dataset.theme;
    if(t==='pink'){ setVars('#ff6f91','#ff9eb5','#ffd1dc') }
    if(t==='lav'){ setVars('#b892ff','#d8b4fe','#fde2ff') }
    if(t==='gal'){ setVars('#0b1026','#141b3a','#1f2a55') }
  });
  document.getElementById('toggleNight').onclick=()=>{
    document.body.classList.toggle('night');
    if(document.body.classList.contains('night')) spawnShooting();
  };
  document.getElementById('picker').oninput=e=> document.documentElement.style.setProperty('--accent', e.target.value);
  function setVars(a,b,c){
    document.documentElement.style.setProperty('--bg1',a);
    document.documentElement.style.setProperty('--bg2',b);
    document.documentElement.style.setProperty('--bg3',c);
  }

  // No dodge + easter egg counter
  function clamp(v,min,max){ return Math.min(Math.max(v,min),max); }
  function moveNo(){
    noCount++;
    const pad=8, maxX=arena.clientWidth-no.offsetWidth-pad, maxY=arena.clientHeight-no.offsetHeight-pad;
    const yR=yes.getBoundingClientRect(), aR=arena.getBoundingClientRect();
    const spots=[
      {x:(yR.left-aR.left)-no.offsetWidth-18, y:(yR.top-aR.top)},
      {x:(yR.right-aR.left)+18, y:(yR.top-aR.top)},
      {x:(yR.left-aR.left), y:(yR.top-aR.top)-no.offsetHeight-18},
      {x:(yR.left-aR.left), y:(yR.bottom-aR.top)+18}
    ];
    const p=spots[Math.floor(Math.random()*spots.length)];
    no.style.left=clamp(p.x,pad,maxX)+'px';
    no.style.top =clamp(p.y,pad,maxY)+'px';
  }
  no.addEventListener('mouseover', moveNo);
  no.addEventListener('touchstart', moveNo, {passive:true});

  // Hidden code LOVE
  document.addEventListener('keydown', e=>{
    code=(code+e.key.toUpperCase()).slice(-4);
    if(code==='LOVE'){
      const t=document.getElementById('toast');
      t.textContent='üß¨ Secret message unlocked: You‚Äôre amazing üíñ';
      t.classList.add('show');
      setTimeout(()=>t.classList.remove('show'),2200);
    }
  });

  // Progress + adaptive questions
  function updateUI(){
    bar.style.width = ((step)/(baseQ.length-1))*100 + '%';
    qEl.textContent = (Math.random()>.5 ? altQ : baseQ)[step];
    sub.textContent = step<3 ? "Just one more üòâ" : "Final question üíò";
    if(step===3 && !unlocked){ yes.classList.add('locked'); unlockMini(); }
  }

  yes.addEventListener('click', ()=>{
    if(step < baseQ.length-1){
      step++; updateUI();
      if(navigator.vibrate) navigator.vibrate(20);
    } else if(unlocked){
      if(navigator.vibrate) navigator.vibrate(40);
      showSuccess();
    }
  });

  function unlockMini(){
    const mini=document.createElement('div');
    mini.style.cssText='position:absolute; inset:0; display:grid; place-items:center; background:rgba(0,0,0,.35); border-radius:28px';
    const h=document.createElement('div');
    h.textContent='üíó';
    h.style.cssText='width:46px;height:46px;border-radius:50%;background:#ff2f6d;color:#fff;display:grid;place-items:center;position:absolute;cursor:pointer';
    mini.appendChild(h);
    document.getElementById('card').appendChild(mini);
    moveHeart(h);
    h.onclick=()=>{ unlocked=true; mini.remove(); yes.classList.remove('locked'); };
    function moveHeart(el){
      const pad=16, maxX=card.clientWidth-el.offsetWidth-pad, maxY=card.clientHeight-el.offsetHeight-pad;
      el.style.left=Math.random()*maxX+'px';
      el.style.top =Math.random()*maxY+'px';
      setTimeout(()=>moveHeart(el), 700);
    }
  }

  // Effects
  function spawn(container, char, dur){
    const s=document.createElement('span');
    s.textContent=char; s.style.left=Math.random()*100+'vw';
    container.appendChild(s); setTimeout(()=>s.remove(), dur);
  }
  setInterval(()=>spawn(document.getElementById('hearts'),'üíó',6000),400);
  setInterval(()=>spawn(document.getElementById('petals'),'üå∏',6000),650);
  setInterval(()=>spawn(document.getElementById('balloons'),'üéà',8000),900);

  // Fireworks
  const canvas=document.getElementById('fw'), ctx=canvas.getContext('2d');
  function resize(){ canvas.width=innerWidth; canvas.height=innerHeight } resize(); addEventListener('resize',resize);
  let rockets=[], particles=[];
  setInterval(()=>rockets.push({x:Math.random()*canvas.width,y:canvas.height,ty:Math.random()*canvas.height*0.5}),900);
  function loop(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    rockets.forEach((r,i)=>{
      r.y-=8; ctx.fillRect(r.x,r.y,2,2);
      if(r.y<r.ty){ for(let j=0;j<30;j++) particles.push({x:r.x,y:r.y,vx:(Math.random()-.5)*6,vy:(Math.random()-.5)*6,life:60,color:`hsl(${Math.random()*360},100%,60%)`}); rockets.splice(i,1); }
    });
    particles.forEach((p,i)=>{ p.x+=p.vx; p.y+=p.vy; p.life--; ctx.fillStyle=p.color; ctx.fillRect(p.x,p.y,3,3); if(p.life<=0) particles.splice(i,1); });
    requestAnimationFrame(loop);
  } loop();

  // Shooting stars in night mode
  function spawnShooting(){
    if(!document.body.classList.contains('night')) return;
    const s=document.createElement('i');
    s.style.left=Math.random()*100+'vw'; s.style.top=Math.random()*50+'vh';
    document.getElementById('shooting').appendChild(s);
    setTimeout(()=>s.remove(), 1100);
    setTimeout(spawnShooting, 1800);
  }

  function showSuccess(){
    document.body.insertAdjacentHTML('beforeend', `
      <div class="success">
        <div class="box">
          <div id="typed"></div>
          <small>So‚Ä¶ coffee sometime? ‚òïüòâ</small>
          <div class="actions">
            <button class="pill" onclick="alert('Tip: Take a screenshot üòâ')">Save this moment üíó</button>
            <button class="pill" onclick="window.open('https://wa.me/?text='+encodeURIComponent('I just clicked YES on your Valentine page üíñ'),'_blank')">Share üíå</button>
            <button class="pill" onclick="location.reload()">Replay üîÑ</button>
          </div>
        </div>
      </div>
    `);
    const msg="Yayyy! üíò You just made my day üòç";
    let i=0, t=document.getElementById('typed');
    const id=setInterval(()=>{ t.textContent+=msg[i++]||""; if(i>msg.length) clearInterval(id); },40);
  }

  updateUI(); // initial
</script>
</body>
</html>
